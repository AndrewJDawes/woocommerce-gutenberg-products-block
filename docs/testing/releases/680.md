## Testing notes and ZIP for release 6.8.0

Zip file for testing: [woocommerce-gutenberg-products-block.zip](https://github.com/woocommerce/woocommerce-gutenberg-products-block/files/7887869/woocommerce-gutenberg-products-block.zip)

## Feature Plugin

### FSE: Add support for the global style for the Price Filter block. ([5559](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5559))

1. Upgrade to `WordPress 5.9`.
2. Install and enable the `Twenty Twenty-Two` theme.
3. Add the `Price Filter block` to a post.
4. On the right sidebar, personalize the styles of the block.
5. Go on the page and check if there are changes.
6. Reset to default using the `Reset` button from the different sections.
7. Go to Dashboard and select Appearance > Editor (beta). On top of the screen, select Home > Browser all templates > Single Post. When the page is loaded, add the block to the page.
8. On the Editor page click on the `Styles` icon on the right-top corner.
9. Verify that the `Price Filter block` is shown under the `Blocks` section. Personalize the block.
10. Save your changes.
11. Go on the page created earlier and check if all styles are applied correctly.
12. Edit your previous post/page again.
13. Change again the styles.
14. Save your changes.
15. Check if these styles have priority over the styles from the Site Editor.

### FSE: Update the block theme folders to latest Gutenberg convention (i.e. `templates` and `parts`). ([5464](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5464))

1. Activate the Gutenberg plugin (or use WordPress 5.9). Select a block theme e.g. TT1 Blocks.
2. Open Appearance > Editor > Templates.
3. Make sure all the templates and parts appear correctly in line with what's available within our directories.
4. Make sure the Mini Cart renders correctly (as it is a template part). Try with and without Gutenberg enabled.

### FSE: Allow users to reinsert the WooCommerce Legacy Template block in their block template if it is a WooCommerce block template. ([5545](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5545))

Note: This is mostly regression testing.

-   Activate the Gutenberg plugin (or use WordPress 5.9).
-   Download the Tove theme: https://en-gb.wordpress.org/themes/tove/. Unzip the theme and copy the archive-product.html file of this release's templates/block-templates directory to the theme's templates directory. Zip the theme folder and upload the theme to your test site.
-   Check Site Editor > Templates and ensure the new template in the theme overrides the default one provided by WooCommerce. Check this also renders correctly on the frontend and within the site editor.
-   Customise the newly created archive-product.html provided by your theme, ensure on the Site Editor > Templates list you are still seeing the customised template in this list and it renders correctly on the frontend, and in site editor.
-   Clear the customisations of the themes archive-product.html template to ensure this works correctly.
-   Check that we're now not receiving 404 network requests for WooCommerce templates on the Site Editor templates list page as described here: https://github.com/woocommerce/woocommerce-gutenberg-products-block/issues/5327

### FSE: Add support for the global style for the Stock Indicator block. ([5525](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5525))

1.  Upgrade to `WordPress 5.9`.
2.  Install and enable the `Twenty Twenty-Two` theme.
3.  Add the `Single Product block` (this block contains `Stock Indicator block`) to a post.
4.  Get the focus on `Stock Indicator block`.
5.  On the right sidebar, personalize the styles of the block.
6.  Go on the page and check if there are changes.
7.  Reset to default using the `Reset` button from the different sections.
8.  Go to Dashboard and select Appearance > Editor (beta). On top of the screen, select Home > Browser all templates > Single Post. When the page is loaded, add the block to the page.
9.  On the Editor page click on the `Styles` icon on the right-top corner.
10. Verify that the `Stock Indicator block` is shown under the `Blocks` section. Personalize the block.
11. Save your changes.
12. Go on the page created earlier and check if all styles are applied correctly.
13. Edit your previous post/page again.
14. Change again the styles.
15. Save your changes.
16. Check if these styles have priority over the styles from the Site Editor.

### FSE: Add support for the global style for the Summary Product block. ([5524](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5524))

1. Upgrade to `WordPress 5.9`.
2. Install and enable the `Twenty Twenty-Two` theme.
3. Add the `Single Product block` (this block contains `Summary Product block`) to a post.
4. Get the focus on `Summary Product block`.
5. On the right sidebar, personalize the styles of the block.
6. Go on the page and check if there are changes.
7. Reset to default using the `Reset` button from the different sections.
8. Go to Dashboard and select Appearance > Editor (beta). On top of the screen, select Home > Browser all templates > Single Post. When the page is loaded, add the block to the page.
9. On the Editor page click on the `Styles` icon on the right-top corner.
10. Verify that the `Summary Product block` is shown under the `Blocks` section. Personalize the block.
11. Save your changes.
12. Go on the page created earlier and check if all styles are applied correctly.
13. Edit your previous post/page again.
14. Change again the styles.
15. Save your changes.
16. Check if these styles have priority over the styles from the Site Editor.

### FSE: Add support for the global style for the Product Title block. ([5515](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5515))

1. Upgrade to `WordPress 5.9`.
2. Install and enable the `Twenty Twenty-Two` theme.
3. Add the `Single Product block` (this block contains `Product Title Block`) to a post.
4. Get the focus on `Product Title block`.
5. On the right sidebar, personalize the styles of the block.
6. Go on the page and check if there are changes.
7. Reset to default using the `Reset` button from the different sections.
8. Go to Dashboard and select Appearance > Editor (beta). On top of the screen, select Home > Browser all templates > Single Post. When the page is loaded, add the block to the page.
9. On the Editor page click on the `Styles` icon on the right-top corner.
10. Verify that the `Product Title block` is shown under the `Blocks` section. Personalize the block.
11. Save your changes.
12. Go on the page created earlier and check if all styles are applied correctly.
13. Edit your previous post/page again.
14. Change again the styles.
15. Save your changes.
16. Check if these styles have priority over the styles from the Site Editor.

### FSE: Add support for the wide and full alignment for the legacy template block. ([5433](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5433))

1. Activate the Gutenberg plugin (or use WordPress 5.9). Select a block theme e.g. TT1 Blocks.
2. From the dashboard, click on Theme > Site Editor.
3. Check Site Editor > Templates.
4. Edit a legacy template (for example `Product Category Page`).
5. Check if you can change the alignment.
6. Change it.
7. Check if the changes are also reflected on the frontend side.

You should test these steps at least one between `Product Category Page`, `Product Archive Page` and `Product Tag Page`.
You should test `Single Product Page`.

### Hold stock for 60mins if the order is pending payment. ([5546](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5546))

1.  Edit an item and ensure it has inventory enabled.
2.  Successfully place an order.

### Fix duplicated checkout error notices. ([5476](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5476))

1. Make sure you're using the Blocks checkout and an payment method configurate (for example Stripe).
2. Add 1 or more products to your cart.
3. Go to the blocks checkout page
4. Pay through the credit card form with a card that will be declined, e.g. 4000 0000 0000 0002.
5. Ensure that only one error notice is displayed

### Store API: Throw errors when attempting to pay with a non-available payment method. ([5440](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5440))

1. Add `add_filter( 'woocommerce_store_api_disable_nonce_check', '__return_true' );` to the bottom of your wp-config.php file to disable nonce checking
2. Enable [basic auth](https://github.com/WP-API/Basic-Auth).
3. Use a REST client such as [Insomnia](https://insomnia.rest/products/insomnia).
4. Use your WP login credentials when making API requests.
5. Add this code somewhere to disable the COD method:

```
add_filter( 'woocommerce_available_payment_gateways', function( $methods ) {
	unset( $methods['cod'] );
	return $methods;
} );
```

**Add an item to the cart:**

`POST https://store.local/wp-json/wc/store/cart/add-item`

```json
{
	"id": 19,
	"quantity": 10
}
```

**Testing invalid Methods**

For each of these tests, confirm there is an error message response (`400`) and the order remains in draft status.

_1. Invalid method:_

`POST https://store.local/wp-json/wc/store/checkout`

```json
{
	"billing_address": {
		"first_name": "Steve",
		"last_name": "Stevenson",
		"address_1": "41 Some Street",
		"city": "Townford",
		"postcode": "CB25 6FG",
		"country": "GB"
	},
	"shipping_address": {
		"first_name": "Steve",
		"last_name": "Stevenson",
		"address_1": "41 Some Street",
		"city": "Townford",
		"postcode": "CB25 6FG",
		"country": "GB"
	},
	"payment_method": "invalid"
}
```

_2. Missing method:_

`POST https://store.local/wp-json/wc/store/checkout`

```json
{
	"billing_address": {
		"first_name": "Steve",
		"last_name": "Stevenson",
		"address_1": "41 Some Street",
		"city": "Townford",
		"postcode": "CB25 6FG",
		"country": "GB"
	},
	"shipping_address": {
		"first_name": "Steve",
		"last_name": "Stevenson",
		"address_1": "41 Some Street",
		"city": "Townford",
		"postcode": "CB25 6FG",
		"country": "GB"
	}
}
```

_3. Non-available method:_

`POST https://store.local/wp-json/wc/store/checkout`

```json
{
	"billing_address": {
		"first_name": "Steve",
		"last_name": "Stevenson",
		"address_1": "41 Some Street",
		"city": "Townford",
		"postcode": "CB25 6FG",
		"country": "GB"
	},
	"shipping_address": {
		"first_name": "Steve",
		"last_name": "Stevenson",
		"address_1": "41 Some Street",
		"city": "Townford",
		"postcode": "CB25 6FG",
		"country": "GB"
	},
	"payment_method": "cod"
}
```

**Testing valid Methods**

Do the following request and confirm the order processes and goes to on-hold status.

`POST https://store.local/wp-json/wc/store/checkout`

```json
{
	"billing_address": {
		"first_name": "Steve",
		"last_name": "Stevenson",
		"address_1": "41 Some Street",
		"city": "Townford",
		"postcode": "CB25 6FG",
		"country": "GB"
	},
	"shipping_address": {
		"first_name": "Steve",
		"last_name": "Stevenson",
		"address_1": "41 Some Street",
		"city": "Townford",
		"postcode": "CB25 6FG",
		"country": "GB"
	},
	"payment_method": "bacs"
}
```

### Store API and Cart block now support defining a quantity stepper and a minimum quantity. ([5406](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5406))

1. Smoke test adding items to cart and changing quantity, either via the + and - buttons, or directly via the input.
2. Edit a product and make it "sold individually"
3. Confirm that no quantity box shows on the cart page for this product
4. Edit a product and set stock to 6, no backorders.
5. Confirm that you can only have 6 maximum for this product.

### Added controls to product grid blocks for filtering by stock levels. ([4943](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/4943))

1. Create a new post.
2. Add a new product grid block (namely, `Products by Attribute`, `Products by Tag`, `Top Rated Products`, `Products by Attribute`, `On Sale Products` or `Newest Products`).
3. In the right hand edit column, open the 'Stock level' panel.
4. Change the drop down menu setting and observe the product list changing to match the new filter.
5. Repeat with any variations and combinations of settings.

### Use consistent HTML code for all rating sections, so that screen readers pronounce the rating correctly. ([5552](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5552))

#### Screenshot

#### Rating type 1 - before

```html
<div class="wc-block-components-product-rating wc-block-grid__product-rating">
	<div
		class="wc-block-components-product-rating__stars wc-block-grid__product-rating__stars"
		role="img"
		aria-label="Rated 4.33 out of 5"
	>
		<span style="width: 86.6%;">Rated 4.33 out of 5</span>
	</div>
</div>
```

#### Rating type 1 - after

```html
<div class="wc-block-components-product-rating wc-block-grid__product-rating">
	<div
		class="wc-block-components-product-rating__stars wc-block-grid__product-rating__stars"
		role="img"
		aria-label="Rated 4.33 out of 5"
	>
		<span style="width: 86.6%;">
			Rated
			<strong class="rating">4.33</strong>
			out of 5 based on
			<span class="rating">3</span>
			customer ratings
		</span>
	</div>
</div>
```

#### Rating type 2 - before

```html
<div
	class="wc-block-review-list-item__rating wc-block-components-review-list-item__rating"
>
	<div
		class="wc-block-review-list-item__rating__stars wc-block-components-review-list-item__rating__stars"
		role="img"
		aria-label="Rated 4 out of 5"
	>
		<span style="width: 80%;">Rated 4 out of 5</span>
	</div>
</div>
```

#### Rating type 2 - after

```html
<div
	class="wc-block-review-list-item__rating wc-block-components-review-list-item__rating"
>
	<div
		class="wc-block-review-list-item__rating__stars wc-block-components-review-list-item__rating__stars"
		role="img"
		aria-label="Rated 4 out of 5"
	>
		<span style="width: 80%;">
			Rated
			<strong class="rating">4</strong>
			out of 5
		</span>
	</div>
</div>
```

#### Rating type 1 - Single rating

1. Create a test page and add a rating type 1 block to it, e.g. the `All Products` block.
2. Ensure to have one product with one rating.
3. Look up that product in the `All Products` block on the frontend.
4. Inspect the HTML code of the rating section.
5. Ensure that the HTML code is displayed as mentioned in the screenshot section and the singular translation is visible.

#### Rating type 1 - Multiple ratings

1. Create a test page and add a rating type 1 block to it, e.g. the `All Products` block.
2. Ensure to have one product with multiple ratings.
3. Look up that product in the `All Products` block on the frontend.
4. Inspect the HTML code of the rating section.
5. Ensure that the HTML code is displayed as mentioned in the screenshot section and the plural translation is visible.

#### Rating type 2 - Single rating

1. Create a test page and add a rating type 2 block to it, e.g. the `All Reviews` block.
2. Ensure to at least one product with a rating.
3. Look up that product in the `All Reviews` block on the frontend.
4. Inspect the HTML code of the rating section.
5. Ensure that the HTML code is displayed as mentioned in the screenshot section.

### All Products block displays thumbnails. ([5551](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5551))

1. Create a new post and add `All Product` block and save it.
2. Add a product with a portrait image ([example you can use](https://user-images.githubusercontent.com/3966773/149120479-b266c2b1-ac13-48e6-944b-6785cd7ee4a9.jpeg)), and one with a landscape image ([example you can use](https://user-images.githubusercontent.com/3966773/149120600-f6e0ef32-16e1-46ec-bd0f-575fc8a658c6.jpeg)).
3. Edit the existing page with the `All Products block` that you had before you checked out this branch. Edit the block, select the image. In the sidebar, under "Block" tab, the "Image Sizing" setting should be "Full Size". This confirms existing blocks are not affected.
4. Visit the page with this block on the front end. Sort by "latest" so that the two new products you added are visible. Notice the aspect ratios of these are different and cause the other items out of alignment.
5. Add the `All Products` block to a new page and save it.
6. Edit the `All products` block, select the image. In the sidebar, under "Block" tab, the "Image Sizing" setting should have "Cropped" selected.
7. Visit this page on the front end and sort by "latest" so that the two new products you added are visible.
8. All product images should be the same aspect ratio and align within the grid.
9. Go to Appearance > Customize > WooCommerce > Product Images and set a custom aspect ratio (for example, 16:9).
10. Visit the all products page again. All product images should be rendered with this new aspect ratio.

### Fixed a styling issue in the Checkout block when an order has multiple shipping packages. ([5529](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5529))

1. Install `Woo Blocks` and `Woo Subscriptions`.
2. Add Simple subscription product with a subscription price and a signup fee.
3. Go to the front-end and add the subscription price to the cart.
4. Go to the `Checkout` block and look at the shipping options, notice that there is a gap between the two shipping options.

### Fixed a visual bug (#5152) with the points and rewards plugin. ([5430](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5430))

1. Install `WooCommerce Points and Rewards`, go to WooCommerce > Points and Rewards and add points to your user.
2. Go to WooCommerce > Points and Rewards > Settings and enable "Allow partial redemption"
3. Go to Cart and see the input to redeem points is showing
4. The text input should be inline with the "Apply Discount" button

### Filter Products By Price block: Don't allow to insert negative values on inputs. ([5123](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5123))

1. Create a post and add `All Products` block and add `Filter Products by Price` block.
2. Save the post.
3. Go to the page having all the above block added.

Check that:

-   the user can't insert in both inputs a negative number.
-   the user can't insert on input left a number that is greater than input on the right.
-   if the user inserts on the input on the right a number that is lower than input on the left, the component sets to 0 the minimum price.

### Remove invalid `$wpdb->prepare()` statement in Featured Category Block. ([5471](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5471))

-   Insert a `Featured Category` block.
-   Confirm the counts shown in the block are still functioning.

### Remove Stripe Payment Method Integration (which is now part of the Stripe Payment Method extension itself). ([5449](https://github.com/woocommerce/woocommerce-gutenberg-products-block/pull/5449))

Install the [Stripe Payment Method Extension](https://github.com/woocommerce/woocommerce-gateway-stripe/), activate it, enable it and test it works by:

1. Adding items to your cart.
2. Go to checkout.
3. Select Stripe Credit Card extension and make a payment. Do so while logged in and save the card to your account.
4. Repeat checkout with a saved card.
